apiVersion: platform.confluent.io/v1beta1
kind: SchemaRegistry
metadata:
  name: schemaregistry
  namespace: confluent
spec:
  replicas: 3
  image:
    application: confluentinc/cp-schema-registry:7.4.0
    init: confluentinc/confluent-init-container:2.6.0
  dependencies: 
    kafka:
      bootstrapEndpoint: osk-kraft-kafka-bootstrap.kafka.svc.cluster.local:9093
  authentication:
    type: basic
    basic:
      secretRef: basicwithrolesr
  tls:
    autoGeneratedCerts: true
  mountedVolumes:         
    volumes:
      - name: kafka-client-tls
        persistentVolumeClaim:
          claimName: kafka-tls-client
    volumeMounts:
      - name: kafka-client-tls
        mountPath: /mnt/ssl
        readOnly: true
  configOverrides:
    server:
      - confluent.schema.registry.authorizer.class=io.confluent.kafka.schemaregistry.security.authorizer.schemaregistryacl.SchemaRegistryAclAuthorizer
      - resource.extension.class=io.confluent.kafka.schemaregistry.security.SchemaRegistrySecurityResourceExtension
      - kafkastore.bootstrap.servers=SSL://osk-kraft-kafka-bootstrap.kafka.svc.cluster.local:9093
      - kafkastore.security.protocol=SSL
      - kafkastore.ssl.truststore.location=/mnt/ssl/user-truststore.jks
      - kafkastore.ssl.truststore.password=xLH0vUrEpLMdI1KVB1ytvZnobTYm7n8y
      - kafkastore.ssl.keystore.location=/mnt/ssl/user-keystore.jks
      - kafkastore.ssl.keystore.password=xLH0vUrEpLMdI1KVB1ytvZnobTYm7n8y
      - kafkastore.ssl.key.password=xLH0vUrEpLMdI1KVB1ytvZnobTYm7n8y
  